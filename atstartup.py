import os
import winreg
import tkinter as tk
from tkinter import filedialog, messagebox
from PIL import Image, ImageTk
import base64
import io

# Image encodée en base64 (remplace ceci par ton image encodée)
image_base64 = """/9j/4AAQSkZJRgABAQEBLAEsAAD/4QEMRXhpZgAASUkqAAgAAAADAA4BAgDCAAAAMgAAABoBBQABAAAA9AAAABsBBQABAAAA/AAAAAAAAABNb2Rlcm4gZGFyayBibHVlIHNtb290aCBidXJyZWQgYWJzdHJhY3QgdmVjdG9yIGJhY2tncm91bmQgZm9yIGJ1c2luZXNzIGRvY3VtZW50cywgY2FyZHMsIGZseWVycywgYmFubmVycywgYWR2ZXJ0aXNpbmcsIGJyb2NodXJlcywgcG9zdGVycywgZGlnaXRhbCBwcmVzZW50YXRpb25zLCBzbGlkZXNob3dzLCBQb3dlclBvaW50LCB3ZWJzaXRlcywBAAABAAAALAEAAAEAAAD/4QYxaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIj4KCTxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CgkJPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczpJcHRjNHhtcENvcmU9Imh0dHA6Ly9pcHRjLm9yZy9zdGQvSXB0YzR4bXBDb3JlLzEuMC94bWxucy8iICAgeG1sbnM6R2V0dHlJbWFnZXNHSUZUPSJodHRwOi8veG1wLmdldHR5aW1hZ2VzLmNvbS9naWZ0LzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGx1cz0iaHR0cDovL25zLnVzZXBsdXMub3JnL2xkZi94bXAvMS4wLyIgIHhtbG5zOmlwdGNFeHQ9Imh0dHA6Ly9pcHRjLm9yZy9zdGQvSXB0YzR4bXBFeHQvMjAwOC0wMi0yOS8iIHhtbG5zOnhtcFJpZ2h0cz0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3JpZ2h0cy8iIHBob3Rvc2hvcDpDcmVkaXQ9IkdldHR5IEltYWdlcyIgR2V0dHlJbWFnZXNHSUZUOkFzc2V0SUQ9IjEyNjkxNjkwNTYiIHhtcFJpZ2h0czpXZWJTdGF0ZW1lbnQ9Imh0dHBzOi8vd3d3LmlzdG9ja3Bob3RvLmNvbS9sZWdhbC9saWNlbnNlLWFncmVlbWVudD91dG1fbWVkaXVtPW9yZ2FuaWMmYW1wO3V0bV9zb3VyY2U9Z29vZ2xlJmFtcDt1dG1fY2FtcGFpZ249aXB0Y3VybCIgcGx1czpEYXRhTWluaW5nPSJodHRwOi8vbnMudXNlcGx1cy5vcmcvbGRmL3ZvY2FiL0RNSS1QUk9ISUJJVEVELUVYQ0VQVFNFQVJDSEVOR0lORUlOREVYSU5HIiA+CjxkYzpjcmVhdG9yPjxyZGY6U2VxPjxyZGY6bGk+ZW5qb3luejwvcmRmOmxpPjwvcmRmOlNlcT48L2RjOmNyZWF0b3I+PGRjOmRlc2NyaXB0aW9uPjxyZGY6QWx0PjxyZGY6bGkgeG1sOmxhbmc9IngtZGVmYXVsdCI+TW9kZXJuIGRhcmsgYmx1ZSBzbW9vdGggYnVycmVkIGFic3RyYWN0IHZlY3RvciBiYWNrZ3JvdW5kIGZvciBidXNpbmVzcyBkb2N1bWVudHMsIGNhcmRzLCBmbHllcnMsIGJhbm5lcnMsIGFkdmVydGlzaW5nLCBicm9jaHVyZXMsIHBvc3RlcnMsIGRpZ2l0YWwgcHJlc2VudGF0aW9ucywgc2xpZGVzaG93cywgUG93ZXJQb2ludCwgd2Vic2l0ZXM8L3JkZjpsaT48L3JkZjpBbHQ+PC9kYzpkZXNjcmlwdGlvbj4KPHBsdXM6TGljZW5zb3I+PHJkZjpTZXE+PHJkZjpsaSByZGY6cGFyc2VUeXBlPSdSZXNvdXJjZSc+PHBsdXM6TGljZW5zb3JVUkw+aHR0cHM6Ly93d3cuaXN0b2NrcGhvdG8uY29tL3Bob3RvL2xpY2Vuc2UtZ20xMjY5MTY5MDU2LT91dG1fbWVkaXVtPW9yZ2FuaWMmYW1wO3V0bV9zb3VyY2U9Z29vZ2xlJmFtcDt1dG1fY2FtcGFpZ249aXB0Y3VybDwvcGx1czpMaWNlbnNvclVSTD48L3JkZjpsaT48L3JkZjpTZXE+PC9wbHVz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222222y22y222yyyyyyyyyzMszMzxmfDM+Xv3fvCI4RDEQ8IYYbYYYbbbbbbbbbbbbbbbbbbbbZZZZZZZZZZZZZlmZmZmZ49ePHrz7v2OHCIiOEMMMMMNsMMNttttttttttttttttttststssssssyyyzMy8Z48Z6z6efd+8IiOEMcGGG3gxbbDbbbbbbbbbbbbbbbbLbbLbLbLLLLxbZ4yyzxnjx9s9e/Z+8OERwht4MMc22Hm22222222222222222222y22zLLbLbLxZlnrPXj6ff3fscIiHox0YYY5sNttttttttttttttttttttvNltm2WWWbZl48Znj18s+Xn3fvojhwfAw222222228222222222223m22y2282W2eLLLPHy8fjeN9376OHDxtttttttttttttttttttvNttttttlt5ststssvXrx6/A+/u/Y4cOHTm22822222222222222222223m222y2y2y82bZ6vWePHj6ePXv3fvkennbbe7bbbbbbbbbbbbbbbbbbbbbbbbbbbbb1l68Znw/A+/s/fBw4edttttt5ttttttttttttttttttvdltlt8bL53j6eM9fbfd+xw4cPe222222922222222222223m222293jbPh8PH53v3fvTh63m9222222223ztttttvN5tts83m229f4H0+fu/fgPG93u2222222222222222222+F7vjZ9P833fvo+DfG92222222223m222+N7vh+Fnj8j7+z9+LfW2923xttttttttvdt7vdt9PyvH5Ps/eHT1vjfG2+Ntt97bb63w+X+Z8/Z+8Hp43xvjbfG2/HtvjfO+3+R68b7P3ycPG+Nt8bb8+/4T7+798nD1vnbfG+t87/e/J9n75OHwbb8G222/wCl93708Hx74223/QfP2fvk/wCFe/d+/wDB519N9n7/AFb/AKf2fvo/zc/ne/Z+/wC/nzfZ++T/AAc95Z8+fI9b7P34j/Sz52b7f3/Cz+jLPhz28+397vT0f4Oec/mes32fvDwP9uWeM5nM7njLLPgz4WZnrfZ+/wBWWdzues854yyyzmfwsz1m+z9/oz5cs85zLLOZ3POfKzPGZvs/f8jLLLLLLOZ6zucz42ZmZm+z9/tzmcyzuczuWWWes8ZZ4fgZmZmZm+z9/vzzllnw5zPGWczufCzMzMzN9n782fPnjPizuWczuczxnjPLMzMzMzfb+/GfPnx5ZZzLOZZ3LLLLPgzj5eMzMzM32fv9Ges5llnMss8ZZzLLOZzOZ4z2+GZmZmZvs/f5c85Z3LOZZZZZZZZ3LLO5ZZ5z2zPWZmZmZm+z9/myzzncs5njOZZZ3LLOZ3LPGWeXjMzMzMzM32fv8WWfDllnM5lnM5lnMs5lnM7nxPGZmZmZmZmb7P35s+PLLLPGdyzxnM5ncs8Z3PbMzMzMzMzM32fv8uWczucyzmWdyyyz1lnyPWZmZmZmZmZm+z9+A9nwZ5yyyzmeM85Z3OZ8L1mZmZmZmZmZm+z98Ho8nDwcOnojh/E8Z6zMzMzMzMzMzN9v7f/Z"""

def add_to_startup():
    path = entry.get()
    if not os.path.exists(path):
        messagebox.showerror("Error", "This File Does Not Exist.")
        return
    
    name = os.path.basename(path)
    key = winreg.HKEY_CURRENT_USER
    registry = r"Software\Microsoft\Windows\CurrentVersion\Run"
    
    try:
        with winreg.OpenKey(key, registry, 0, winreg.KEY_SET_VALUE) as regkey:
            winreg.SetValueEx(regkey, name, 0, winreg.REG_SZ, path)
        messagebox.showinfo("Succès", f"{name} a été ajouté au démarrage.")
    except Exception as e:
        messagebox.showerror("Error", f"Cant add this app : {e}")

def remove_from_startup():
    path = entry.get()
    name = os.path.basename(path)
    key = winreg.HKEY_CURRENT_USER
    registry = r"Software\Microsoft\Windows\CurrentVersion\Run"
    
    try:
        with winreg.OpenKey(key, registry, 0, winreg.KEY_SET_VALUE) as regkey:
            winreg.DeleteValue(regkey, name)
        messagebox.showinfo("Success", f"{name} is not a startup app anymore.")
    except FileNotFoundError:
        messagebox.showwarning("Warning", "This app is not a startup app")
    except Exception as e:
        messagebox.showerror("Error", f"Cant delete startup app : {e}")

def browse_file():
    file_path = filedialog.askopenfilename(filetypes=[("Executables File", "*.exe")])
    if file_path:
        entry.delete(0, tk.END)
        entry.insert(0, file_path)

# Interface Tkinter
root = tk.Tk()
root.title("At Startup V1")
root.geometry("400x200")

# Chargement de l'image de fond
image_data = base64.b64decode(image_base64)
image = Image.open(io.BytesIO(image_data))
photo = ImageTk.PhotoImage(image)
background_label = tk.Label(root, image=photo)
background_label.place(relwidth=1, relheight=1)

frame = tk.Frame(root, bg='white')
frame.pack(pady=20)

entry = tk.Entry(frame, width=40)
entry.pack(side=tk.LEFT, padx=5)

browse_btn = tk.Button(frame, text="Browse", command=browse_file)
browse_btn.pack(side=tk.RIGHT)

add_btn = tk.Button(root, text="Add to startup", command=add_to_startup)
add_btn.pack(pady=5)

remove_btn = tk.Button(root, text="Delete from startup", command=remove_from_startup)
remove_btn.pack(pady=5)

root.mainloop()
